!function(t,o){"function"==typeof define&&define.amd?define(["jquery"],function(t){return o(t)}):"object"==typeof module&&module.exports?module.exports=o(require("jquery")):o(t.jQuery)}(this,function(t){!function(t){"use strict";var o,i=Object.prototype.toString,e=function(i,e){var n=o.find(":input[name='"+i+"']");if("checkbox"==n.attr("type")){if(null!==e)for(var s=t("[name='"+i+"']"),a=e.split(","),r=0;r<s.length;r++)for(var d=0;d<a.length;d++)s[r].value==a[d]&&s[r].click()}else if("radio"==n.attr("type"))n.each(function(){for(var o=t("[name='"+i+"']"),n=0;n<o.length;n++)o[n].value==e&&o[n].click()});else if("textarea"==n.attr("type"))o.find("[name='"+i+"']").html(e);else if(n[0]&&"SELECT"==n[0].tagName)o.find("[name='"+i+"']").val(e).trigger("change");else{var l=o.find("[name='"+i+"']");l.length>0&&(l.val(e),l.each(function(){if(t(this).is(".image")){var o=t(this).val(),i=t(this).parent(),e=o.split(","),n=_.template(t("#template"+i.data("id")).html());if(e.length>0){"0"==i.data("multi")&&i.find(".uploader-box").remove();for(var s=0;s<e.length;s++){var a=n({img:e[s]});i.append(a)}}}}))}};t.fn.setform=function(n){o=this,t.each(n,function(o,n){"[object Object]"==i.call(n)?t.each(n,function(t,i){e(o+"."+t,i)}):"[object Array]"==i.call(n)?console.log("["+o+"][object Array]字段是数组类型,斩不支持"):e(o,n)})}}(t),+function(t){"use strict";var o={_positionClasses:["bottom-left","bottom-right","top-right","top-left","bottom-center","top-center","mid-center"],_defaultIcons:["success","error","info","warning"],init:function(o,i){this.prepareOptions(o,t.toast.options),this.process()},prepareOptions:function(o,i){var e={};"string"==typeof o||o instanceof Array?e.text=o:e=o,this.options=t.extend({},i,e)},process:function(){this.setup(),this.addToDom(),this.position(),this.bindToast(),this.animate()},setup:function(){var o="";if(this._toastEl=this._toastEl||t("<div></div>",{class:"jq-toast-single"}),o+='<span class="jq-toast-loader"></span>',this.options.allowToastClose&&(o+='<span class="close-jq-toast-single">&times;</span>'),this.options.text instanceof Array){this.options.heading&&(o+='<h2 class="jq-toast-heading">'+this.options.heading+"</h2>"),o+='<ul class="jq-toast-ul">';for(var i=0;i<this.options.text.length;i++)o+='<li class="jq-toast-li" id="jq-toast-item-'+i+'">'+this.options.text[i]+"</li>";o+="</ul>"}else this.options.heading&&(o+='<h2 class="jq-toast-heading">'+this.options.heading+"</h2>"),o+=this.options.text;this._toastEl.html(o),this.options.bgColor!==!1&&this._toastEl.css("background-color",this.options.bgColor),this.options.textColor!==!1&&this._toastEl.css("color",this.options.textColor),this.options.textAlign&&this._toastEl.css("text-align",this.options.textAlign),this.options.icon!==!1&&(this._toastEl.addClass("jq-has-icon"),t.inArray(this.options.icon,this._defaultIcons)!==-1&&this._toastEl.addClass("jq-icon-"+this.options.icon))},position:function(){"string"==typeof this.options.position&&t.inArray(this.options.position,this._positionClasses)!==-1?"bottom-center"===this.options.position?this._container.css({left:t(window).outerWidth()/2-this._container.outerWidth()/2,bottom:20}):"top-center"===this.options.position?this._container.css({left:t(window).outerWidth()/2-this._container.outerWidth()/2,top:20}):"mid-center"===this.options.position?this._container.css({left:t(window).outerWidth()/2-this._container.outerWidth()/2,top:t(window).outerHeight()/2-this._container.outerHeight()/2}):this._container.addClass(this.options.position):"object"==typeof this.options.position?this._container.css({top:this.options.position.top?this.options.position.top:"auto",bottom:this.options.position.bottom?this.options.position.bottom:"auto",left:this.options.position.left?this.options.position.left:"auto",right:this.options.position.right?this.options.position.right:"auto"}):this._container.addClass("bottom-left")},bindToast:function(){var t=this;this._toastEl.on("afterShown",function(){t.processLoader()}),this._toastEl.find(".close-jq-toast-single").on("click",function(o){o.preventDefault(),"fade"===t.options.showHideTransition?(t._toastEl.trigger("beforeHide"),t._toastEl.fadeOut(function(){t._toastEl.trigger("afterHidden")})):"slide"===t.options.showHideTransition?(t._toastEl.trigger("beforeHide"),t._toastEl.slideUp(function(){t._toastEl.trigger("afterHidden")})):(t._toastEl.trigger("beforeHide"),t._toastEl.hide(function(){t._toastEl.trigger("afterHidden")}))}),"function"==typeof this.options.beforeShow&&this._toastEl.on("beforeShow",function(){t.options.beforeShow()}),"function"==typeof this.options.afterShown&&this._toastEl.on("afterShown",function(){t.options.afterShown()}),"function"==typeof this.options.beforeHide&&this._toastEl.on("beforeHide",function(){t.options.beforeHide()}),"function"==typeof this.options.afterHidden&&this._toastEl.on("afterHidden",function(){t.options.afterHidden()}),"function"==typeof this.options.onClick&&this._toastEl.on("click",function(){t.options.onClick()})},addToDom:function(){var o=t(".jq-toast-wrap");if(0===o.length?(o=t("<div></div>",{class:"jq-toast-wrap"}),t("body").append(o)):this.options.stack&&!isNaN(parseInt(this.options.stack,10))||o.empty(),o.find(".jq-toast-single:hidden").remove(),o.append(this._toastEl),this.options.stack&&!isNaN(parseInt(this.options.stack),10)){var i=o.find(".jq-toast-single").length,e=i-this.options.stack;e>0&&t(".jq-toast-wrap").find(".jq-toast-single").slice(0,e).remove()}this._container=o},canAutoHide:function(){return this.options.hideAfter!==!1&&!isNaN(parseInt(this.options.hideAfter,10))},processLoader:function(){if(!this.canAutoHide()||this.options.loader===!1)return!1;var t=this._toastEl.find(".jq-toast-loader"),o=(this.options.hideAfter-400)/1e3+"s",i=this.options.loaderBg,e=t.attr("style")||"";e=e.substring(0,e.indexOf("-webkit-transition")),e+="-webkit-transition: width "+o+" ease-in; \t                      -o-transition: width "+o+" ease-in; \t                      transition: width "+o+" ease-in; \t                      background-color: "+i+";",t.attr("style",e).addClass("jq-toast-loaded")},animate:function(){var t=this;if(this._toastEl.hide(),this._toastEl.trigger("beforeShow"),"fade"===this.options.showHideTransition.toLowerCase()?this._toastEl.fadeIn(function(){t._toastEl.trigger("afterShown")}):"slide"===this.options.showHideTransition.toLowerCase()?this._toastEl.slideDown(function(){t._toastEl.trigger("afterShown")}):this._toastEl.show(function(){t._toastEl.trigger("afterShown")}),this.canAutoHide()){var t=this;window.setTimeout(function(){"fade"===t.options.showHideTransition.toLowerCase()?(t._toastEl.trigger("beforeHide"),t._toastEl.fadeOut(function(){t._toastEl.trigger("afterHidden")})):"slide"===t.options.showHideTransition.toLowerCase()?(t._toastEl.trigger("beforeHide"),t._toastEl.slideUp(function(){t._toastEl.trigger("afterHidden")})):(t._toastEl.trigger("beforeHide"),t._toastEl.hide(function(){t._toastEl.trigger("afterHidden")}))},this.options.hideAfter)}},reset:function(o){"all"===o?t(".jq-toast-wrap").remove():this._toastEl.remove()},update:function(t){this.prepareOptions(t,this.options),this.setup(),this.bindToast()}};t.toast=function(t){var i=Object.create(o);return i.init(t,this),{reset:function(t){i.reset(t)},update:function(t){i.update(t)}}},t.toast.options={text:"",heading:"",showHideTransition:"fade",allowToastClose:!0,hideAfter:2e3,loader:!0,loaderBg:"#9EC600",stack:5,position:"bottom-left",bgColor:!1,textColor:!1,textAlign:"left",icon:!1,beforeShow:function(){},afterShown:function(){},beforeHide:function(){},afterHidden:function(){},onClick:function(){}}}(t),+function(t){"use strict";t.extend({getUrlParams:function(){var t,o,i,e=window.location.href,n={},s=e.indexOf("?"),a=e.indexOf("#"),r=e.substr(s+1);if(a===-1&&(a=e.length),r)for(t=r.split("&"),i=t.length;i--;)o=t[i].split("="),n[o[0]]=decodeURIComponent(o[1]).replace(/\+/g," ");return n},getUrlParam:function(t){return this.getUrlParams()[t]},getJsonData:function(o){var i={};return t.each(o.data(),function(t,o){"object"!=typeof o&&"url"!=t&&(i[t]=o)}),i},getParamData:function(o,i){var e=this.getJsonData(o);return e=t.extend(e,i||{}),t.param(e)},arrToStr:function(t){return(t||[]).join(",").replace(/^[]/,"")}}),t(window).on("load",function(){function o(){var o=/(\w*)=([a-zA-Z0-9\u4e00-\u9fa5]+)/gi,i={};decodeURIComponent(window.location.href,!0).replace(o,function(t,o,e){i[o]=e});var e=t("form#form"+i.formid);1==e.length&&t.ajax({type:"POST",url:e.data("url"),data:i,dataType:"json",success:function(o){"success"==o.status||1==o.status?e.setform(o.rows[0]):t.toast({heading:"温馨提示",text:o.message,position:"top-center",stack:!1,icon:"success"})},error:function(o,i){e.data("load","1"),t.toast({heading:"温馨提示",text:"加载数据出错",position:"top-center",stack:!1,icon:"error"})}})}function i(){var e=0;t('[data-ride="loadData"]').each(function(){"1"==t(this).data("load")&&e++}),e==n?(null!=s&&clearTimeout(s),o()):s=setTimeout(function(){i()},100)}if(t(".uploader-input").length>0){var e=UE.getEditor("upload_ue");window.picEditor=e,e.ready(function(){e.setDisabled("insertimage"),e.hide(),e.addListener("afterinsertimage",function(t,o){e.setContent("")})})}if(t(".usereditor").each(function(){UE.getEditor(t(this).attr("id"))}),t('[data-ride="form"]').each(function(){var o=t(this);o.bootstrapValidator().on("success.form.bv",function(i){i.preventDefault();var e=t(i.target),n=null;e.ajaxSubmit({type:"post",dataType:"json",beforeSend:function(){n=t.dialog({title:"温馨提示",content:"正在保存数据，请等待..."})},success:function(i){if(n&&n.close(),t.toast({heading:"温馨提示",text:i.message,position:"top-center",stack:!1}),1==i.status||"true"==i.status||"success"==i.status){var e=i.goPage;e?location.href=e:history.back()}o.bootstrapValidator("disableSubmitButtons",!1)}})})}),t.getUrlParam("_ajax_edit_page")&&"1"==t.getUrlParam("_ajax_edit_page")){var n=t('[data-ride="loadData"]').length,s=null;i()}t(document).off("change.input-image","input.image").on("change.input-image","input.image",function(o){o.stopPropagation(),o.preventDefault();var i=[];t(this).siblings(".uploader-box").each(function(){var o=t(this).find("img").attr("src");o.indexOf("/images/upload.jpg")<0&&i.push(o)}),t(this).val(t.arrToStr(i)),t(this).trigger("input.update.bv")}),t(document).off("click.uploader-input",".uploader-box").on("click.uploader-box",".uploader-box",function(o){o.stopPropagation(),o.preventDefault();var i=t(this),e=i.parent();window.picEditor.setOptFalse("selectOneImage","0"==e.data("multi"));var n=window.picEditor.getDialog("insertimage");window.picEditor.removeListener("beforeInsertImage"),window.picBox=i,window.picEditor.addListener("beforeInsertImage",function(o,i){var e=window.picBox.parent(),n=_.template(t("#template"+e.data("id")).html());if(i.length>0){"0"==e.data("multi")&&e.find(".uploader-box").remove();for(var s=e.find("input.image").val(),a=0;a<i.length;a++)if(s.indexOf(i[a].src)<0){var r=n({img:i[a].src});e.append(r)}e.find("input.image").trigger("change.input-image")}}),n.open()}),t(document).off("click.uploader-input.btn",".uploader-box .btn").on("click.uploader-box.btn",".uploader-box .btn",function(o){o.stopPropagation(),o.preventDefault();var i=t(this).closest(".uploader-box"),e=i.parent();"0"==e.data("multi")?(i.find("img").attr("src","/static/images/upload.jpg"),i.find(".btn-toolbar").remove()):i.remove(),e.find("input.image").trigger("change.input-image")})})}(t)});